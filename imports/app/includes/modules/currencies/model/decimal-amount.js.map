{"version":3,"file":"decimal-amount.js","names":["DecimalAmount","session","amount","decimals","global","getGlobalObject","_globalscope","getExecutionGlobalScope","_simplestore","simplestore","BigNumber","bignumber","decimalamount","toInteger","amount_int","decimalamount_int","amountstring","toString","parseInt","_formatAmount","undefined","multiplier","multipliedBy","_mnt","integerValue","Promise","reject","plus","options","_inputamountstring","length","integerpart","substring","leading","i","showdecimals","indexOf","decimalsshown","window","GlobalClass","_GlobalClass","Global","registerModuleClass"],"sources":["../../../../../../../../../imports/app/includes/modules/currencies/model/decimal-amount.js"],"sourcesContent":["'use strict';\n\nvar DecimalAmount = class {\n\tconstructor(session, amount, decimals) {\n\t\tthis.session = session;\n\t\tthis.amount = amount;\n\t\tthis.decimals = decimals;\n\t\t\n \t\tvar global = session.getGlobalObject();\n\t\tvar _globalscope = global.getExecutionGlobalScope();\n\t\tvar _simplestore = _globalscope.simplestore;\n\n\t\tthis.BigNumber = _simplestore.BigNumber;\n\t\tthis.bignumber = new this.BigNumber(amount);\n\t\t\n\t}\n\n\tasync equals(decimalamount) {\n\t\tvar amount_int = await this.toInteger();\n\t\tvar decimalamount_int = await decimalamount.toInteger();\n\n\t\tif (amount_int === decimalamount_int)\n\t\t\treturn true;\n\t\telse\n\t\t\treturn false;\n\t}\n\n\tasync toString() {\n\t\tvar amountstring = (this.amount ? this.amount.toString() : '0');\n\n\t\treturn amountstring;\n\t}\n\n\tasync toInteger() {\n\t\tvar amountstring = await this.toString();\n\t\treturn parseInt(amountstring);\n\t}\n\n\tasync toFixedString() {\n\t\tvar session = this.session;\n\n\t\tvar amountstring = await this._formatAmount(session, (this.amount !== undefined ? this.amount : 0), this.decimals);\n\n\t\treturn amountstring;\n\t}\n\n\tasync multiply(multiplier) {\n\t\tthis.amount = multiplier * this.amount;\n\n\t\tthis.bignumber.multipliedBy(multiplier);\n\n\t\tvar _mnt = this.bignumber.integerValue();\n\n\t\treturn this;\n\t}\n\n\tasync add(decimalamount) {\n\t\tif ((decimalamount instanceof DecimalAmount) !== true)\n\t\t\treturn Promise.reject('wrong decimal amount type');\n\n\t\tthis.amount += decimalamount.amount;\n\n\t\tthis.bignumber.plus(decimalamount.amount);\n\n\t\tvar _mnt = this.bignumber.integerValue();\n\n\t\treturn this;\n\t}\n\n\tstatic async create(session, amount, decimals) {\n\t\t// analyse amount type transform it to integer\n\t\treturn new DecimalAmount(session, amount, decimals);\n\t}\n\n\tasync _formatAmount(session, amount, decimals, options) {\n\t\tif (amount === undefined)\n\t\t\treturn;\n\t\t\n\t\tvar _inputamountstring = amount.toString();\n\t\tvar amountstring;\n\t\t\n\t\tif (_inputamountstring.length > decimals) {\n\t\t\t// integer part\n\t\t\tvar integerpart = _inputamountstring.substring(0, _inputamountstring.length - decimals);\n\n\t\t\tamountstring = integerpart + '.' + _inputamountstring.substring(_inputamountstring.length - decimals);\n\t\t}\n\t\telse {\n\t\t\tvar leading = '';\n\t\t\tfor (var i = 0; i < (decimals -_inputamountstring.length) ; i++) leading += '0';\n\t\t\tamountstring = '0.' + leading + _inputamountstring;\n\t\t}\n\n\t\tif (options) {\n\t\t\tif (typeof options.showdecimals !== 'undefined') {\n\t\t\t\tif (options.showdecimals === false) {\n\t\t\t\t\t// we remove . and after\n\t\t\t\t\tamountstring = amountstring.substring(0, amountstring.indexOf('.'));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tvar decimalsshown = (options.decimalsshown ? options.decimalsshown : decimals);\n\t\t\t\t\tamountstring = amountstring.substring(0, amountstring.indexOf('.') + 1 + decimalsshown);\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\treturn amountstring;\n\t}\n}\n\n\nif ( typeof window !== 'undefined' && typeof window.GlobalClass !== 'undefined' && window.GlobalClass ) {\n\tvar _GlobalClass = window.GlobalClass;\n}\nelse if (typeof window !== 'undefined') {\n\tvar _GlobalClass = ( window && window.simplestore && window.simplestore.Global ? window.simplestore.Global : null);\n}\nelse if (typeof global !== 'undefined') {\n\t// we are in node js\n\tvar _GlobalClass = ( global && global.simplestore && global.simplestore.Global ? global.simplestore.Global : null);\n}\n\n_GlobalClass.registerModuleClass('currencies', 'DecimalAmount', DecimalAmount);\n"],"mappings":"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"}