{"version":3,"file":"uniswap-access.js","names":["UniswapAccess","session","module","global","scheme","token1","token2","token2amount","uniswap_conf","price","ethnodeserverconfig","getEthNodeServerConfig","web3providerurl","getWeb3ProviderUrl","addWeb3Provider","UniswapV2FactoryAddress","factory","UniswapV2Router02Address","router","networkid","uniswapfactoryinterface","getV2FactoryContratInterface","getPairAddress","address","pair_address","uniswappairinterface","getV2PairContratInterface","getReserves","reserves","uniswaprouter02interface","getV2Router02ContratInterface","quote","reserve0","reserve1","quote2","path","push","WETH","getAmountsIn","amounts_in","unit_amount_in","getAmountsOut","amounts_out","unit_amount_out","console","log","stack","tokenaddress","erc20tokenmodule","getModuleObject","data","erc20tokencontrollers","getControllersObject","erc20tokencontract","createERC20TokenObject","token1amountmax","weth","ethamount","ethtx","erc20token1contract","_importERC20Token","routercontractaccount","createBlankAccountObject","setAddress","allowance","getFromAccount","parseInt","alloweraccount","gas","getGas","gasPrice","getGasPrice","approve","Promise","reject","deadline","Date","now","swapTokensForExactETH","result","swapTokensForExactTokens","contractaddress","FactoryContractInterfaceClass","V2_FactoryContractInterface","PairContractInterfaceClass","V2_PairContractInterface","Router02InterfaceClass","V2_Router02ContractInterface","window","GlobalClass","_GlobalClass","simplestore","Global","registerModuleClass"],"sources":["../../../../../../../../../imports/app/includes/modules/uniswap/model/uniswap-access.js"],"sourcesContent":["'use strict';\n\nvar UniswapAccess = class {\n\tconstructor(session, module) {\n\t\tthis.session = session;\n\t\tthis.module = module;\n\t\tthis.global = this.module.global;\n\t}\n\n\tasync getPriceForOutput(scheme, token1, token2, token2amount, uniswap_conf) {\n\t\tvar global = this.global;\n\t\tvar session = this.session;\n\t\t\n\t\ttry {\n\t\t\tvar price = {};\n\n\t\t\tif (!uniswap_conf)\n\t\t\t\treturn price;\n\n\t\t\tvar ethnodeserverconfig = scheme.getEthNodeServerConfig();\n\t\t\t\n\t\t\tlet web3providerurl = scheme.getWeb3ProviderUrl();\n\n\n\t\t\tthis.module.addWeb3Provider(scheme);\n\n\t\t\n\t\t\t// conf\n\t\t\tvar UniswapV2FactoryAddress = uniswap_conf.factory;\n\t\t\tvar UniswapV2Router02Address = uniswap_conf.router;\n\t\t\t\n\n\t\t\t// contract methods\n\t\t\tvar networkid = ethnodeserverconfig.networkid;\n\n\t\t\tvar uniswapfactoryinterface = this.getV2FactoryContratInterface(session, UniswapV2FactoryAddress, web3providerurl);\n\n\t\t\tconst pair_address = await uniswapfactoryinterface.getPairAddress(token1.address, token2.address);\n\n\t\t\tvar uniswappairinterface = this.getV2PairContratInterface(session, pair_address, web3providerurl)\n\t\t\tconst reserves = await uniswappairinterface.getReserves();\n\n\t\t\tvar uniswaprouter02interface = this.getV2Router02ContratInterface(session, UniswapV2Router02Address, web3providerurl);\n\n\t\t\tvar quote2 = await uniswaprouter02interface.quote(1, reserves.reserve0, reserves.reserve1);\n\n\t\t\tvar path = [];\n\t\t\tpath.push(token1.address);\n\t\t\tpath.push(token2.address);\n\n\t\t\tconst WETH = await uniswaprouter02interface.WETH();\n\n\n\t\t\tprice.amounts_in = await uniswaprouter02interface.getAmountsIn(token2amount, path);\n\t\t\tprice.unit_amount_in = await uniswaprouter02interface.getAmountsIn(1, path);\n\n\t\t\tprice.amounts_out = await uniswaprouter02interface.getAmountsOut(token2amount, path);\n\t\t\tprice.unit_amount_out = await uniswaprouter02interface.getAmountsOut(1, path);\n\n\t\t\treturn price;\n\t\t}\n\t\tcatch(e) {\n\t\t\tconsole.log('exception ' + e);\n\t\t\tconsole.log(e.stack);\n\t\t}\n\t}\n\n\t_importERC20Token(session, tokenaddress) {\n\t\tvar global = this.global;\n\t\t\n\t\tvar erc20tokenmodule = global.getModuleObject('erc20');\n\t\t\n\t\tvar data = {};\n\t\t\n\t\tdata['description'] = tokenaddress;\n\t\tdata['address'] = tokenaddress;\n\t\t\n\t\tvar erc20tokencontrollers = erc20tokenmodule.getControllersObject();\n\t\t\n\t\t// create (local) contract for these values\n\t\tvar erc20tokencontract = erc20tokencontrollers.createERC20TokenObject(session, data);\n\t\t\n\t\treturn erc20tokencontract;\n\t}\n\n\tasync buyEthOnOutput(scheme, token1, token1amountmax, weth, ethamount, uniswap_conf, ethtx) {\n\t\tvar global = this.global;\n\t\tvar session = this.session;\n\t\t\n\t\ttry {\n\t\t\tlet web3providerurl = scheme.getWeb3ProviderUrl();\n\n\t\t\t// conf\n\t\t\tvar UniswapV2FactoryAddress = uniswap_conf.factory;\n\t\t\tvar UniswapV2Router02Address = uniswap_conf.router;\n\n\t\t\tvar uniswaprouter02interface = this.getV2Router02ContratInterface(session, UniswapV2Router02Address, web3providerurl);\n\n\t\t\t// check first that contract has enough allowance on sender account\n\t\t\tvar erc20token1contract = this._importERC20Token(session, token1.address);\n\n\t\t\tvar routercontractaccount = session.createBlankAccountObject();\n\t\t\troutercontractaccount.setAddress(UniswapV2Router02Address);\n\n\t\t\tvar allowance = await erc20token1contract.allowance(ethtx.getFromAccount(), routercontractaccount);\n\n\t\t\tif (parseInt(allowance) < token1amountmax) {\n\t\t\t\tlet alloweraccount = ethtx.getFromAccount();\n\t\t\t\tlet gas = ethtx.getGas(); // we re-use the fees for the original transaction\n\t\t\t\tlet gasPrice = ethtx.getGasPrice();\n\n\t\t\t\tconst approve = await erc20token1contract.approve(routercontractaccount, token1amountmax, alloweraccount, gas, gasPrice);\n\n\t\t\t\tif (!approve)\n\t\t\t\t\treturn Promise.reject('could not approve contract on token');\n\t\t\t}\n\n\t\t\tvar path = [];\n\t\t\tpath.push(token1.address);\n\t\t\tpath.push(weth.address);\n\n\t\t\tvar deadline = Date.now() + 5 * 60; // 5 minutes\n\t\t\t\n\t\t\tvar result = await uniswaprouter02interface.swapTokensForExactETH(ethamount, token1amountmax, path, deadline, ethtx);\n\n\t\t\treturn result;\n\t\t}\n\t\tcatch(e) {\n\t\t\tconsole.log('exception ' + e);\n\t\t\tconsole.log(e.stack);\n\t\t}\n\t}\n\n\n\tasync buyTokensOnOutput(scheme, token1, token1amountmax, token2, token2amount, uniswap_conf, ethtx) {\n\t\tvar global = this.global;\n\t\tvar session = this.session;\n\t\t\n\t\ttry {\n\t\t\tlet web3providerurl = scheme.getWeb3ProviderUrl();\n\n\t\t\t// conf\n\t\t\tvar UniswapV2FactoryAddress = uniswap_conf.factory;\n\t\t\tvar UniswapV2Router02Address = uniswap_conf.router;\n\n\t\t\tvar uniswaprouter02interface = this.getV2Router02ContratInterface(session, UniswapV2Router02Address, web3providerurl);\n\n\t\t\t// check first that contract has enough allowance on sender account\n\t\t\tvar erc20token1contract = this._importERC20Token(session, token1.address);\n\n\t\t\tvar routercontractaccount = session.createBlankAccountObject();\n\t\t\troutercontractaccount.setAddress(UniswapV2Router02Address);\n\n\t\t\tvar allowance = await erc20token1contract.allowance(ethtx.getFromAccount(), routercontractaccount);\n\n\t\t\tif (parseInt(allowance) < token1amountmax) {\n\t\t\t\tlet alloweraccount = ethtx.getFromAccount();\n\t\t\t\tlet gas = ethtx.getGas(); // we re-use the fees for the original transaction\n\t\t\t\tlet gasPrice = ethtx.getGasPrice();\n\n\t\t\t\tconst approve = await erc20token1contract.approve(routercontractaccount, token1amountmax, alloweraccount, gas, gasPrice);\n\n\t\t\t\tif (!approve)\n\t\t\t\t\treturn Promise.reject('could not approve contract on token');\n\t\t\t}\n\n\t\t\tvar path = [];\n\t\t\tpath.push(token1.address);\n\t\t\tpath.push(token2.address);\n\n\t\t\tvar deadline = Date.now() + 5 * 60; // 5 minutes\n\t\t\t\n\t\t\tvar result = await uniswaprouter02interface.swapTokensForExactTokens(token2amount, token1amountmax, path, deadline, ethtx);\n\n\t\t\treturn result;\n\t\t}\n\t\tcatch(e) {\n\t\t\tconsole.log('exception ' + e);\n\t\t\tconsole.log(e.stack);\n\t\t}\n\t}\n\n\n\t// v2\n\tgetV2FactoryContratInterface(session, contractaddress, web3providerurl) {\n\t\tvar global = this.global;\n\n\t\tvar FactoryContractInterfaceClass = this.module.V2_FactoryContractInterface;\n\n\t\treturn new FactoryContractInterfaceClass(session, contractaddress, web3providerurl);\n\t}\n\n\tgetV2PairContratInterface(session, contractaddress, web3providerurl) {\n\t\tvar global = this.global;\n\n\t\tvar PairContractInterfaceClass = this.module.V2_PairContractInterface;\n\n\t\treturn new PairContractInterfaceClass(session, contractaddress, web3providerurl);\n\t}\n\n\tgetV2Router02ContratInterface(session, contractaddress, web3providerurl) {\n\t\tvar global = this.global;\n\n\t\tvar Router02InterfaceClass = this.module.V2_Router02ContractInterface;\n\n\t\treturn new Router02InterfaceClass(session, contractaddress, web3providerurl);\n\t}\n\n\n}\n\nif ( typeof window !== 'undefined' && typeof window.GlobalClass !== 'undefined' && window.GlobalClass ) {\n\tvar _GlobalClass = window.GlobalClass;\n}\nelse if (typeof window !== 'undefined') {\n\tvar _GlobalClass = ( window && window.simplestore && window.simplestore.Global ? window.simplestore.Global : null);\n}\nelse if (typeof global !== 'undefined') {\n\t// we are in node js\n\tvar _GlobalClass = ( global && global.simplestore && global.simplestore.Global ? global.simplestore.Global : null);\n}\n\n_GlobalClass.registerModuleClass('uniswap', 'UniswapAccess', UniswapAccess);\n"],"mappings":"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"}