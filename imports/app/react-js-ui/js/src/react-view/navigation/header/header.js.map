{"version":3,"file":"header.js","names":["Header","props","app","getMvcModuleObject","closing","MenuLinks","require","webapp_menulinks","getMenuLinks","state","isLoggedIn","hasOpenWallet","isdevicewallet","hasReturnPath","prevProps","prevState","console","log","currentwalletuuid","rootsessionuuid","walletuuid","isDeviceWallet","then","setState","err","checkWalletUnlocked","unlocked","canreturn","faUnlock","faMobileAlt","faLock","item","index","type","route","label","onclick","menulinks","push","gotoRoute","returnToCaller","length","concat","_getMenuLinks","faHome","renderLock","faBars","map","renderMenuLink","nextProps","iswalletlocked","React","Component","propTypes","PropTypes","object","isRequired","string","bool","lastLoggedInCheck","number","loggedInCheckPending","unlockpending","mapStateToProps","session","sessionuuid","login","success","checkpending","checkedon","currentwallet","wallets","walletname","openpending","islocked","mapDispatchToProps","dispatch","connect"],"sources":["../../../../../../../../../../../imports/app/react-js-ui/js/src/react-view/navigation/header/header.js"],"sourcesContent":["import React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Link } from \"react-router-dom\";\n\nimport { Navbar, NavDropdown, NavItem } from 'react-bootstrap';\nimport { LinkContainer } from \"react-router-bootstrap\";\n\nimport { faHome, faLock, faUnlock, faMobileAlt, faBars } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport PropTypes from 'prop-types';\n\nclass Header extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\t\n\t\tthis.app = this.props.app;\n\t\tthis.getMvcModuleObject = this.app.getMvcModuleObject;\n\n\t\tthis.closing = false;\n\t\t\n\t\t// load dynamic menu links\n\t\tconst MenuLinks = require('./menulinks/menulinks.js');\n\t\tthis.webapp_menulinks = MenuLinks.default.getMenuLinks(this.app);\n\n\t\tthis.state = {\n\t\t\tisLoggedIn: false,\n\t\t\thasOpenWallet: false,\n\t\t\tisdevicewallet: false,\n\t\t\thasReturnPath: false\n\t\t}\n\t}\t\n\n\t// post render commit phase\n\tcomponentDidUpdate(prevProps, prevState) {\n\t\tconsole.log('Header.componentDidUpdate called');\n\n\t\tif (this.props.currentwalletuuid) {\n\t\t\tlet rootsessionuuid = this.props.rootsessionuuid;\n\t\t\tlet walletuuid = this.props.currentwalletuuid;\n\t\t\t\n\t\t\t// check if wallet it is not the device wallet\n\t\t\tif (walletuuid && (this.state.isdevicewallet !== true))\n\t\t\tthis.app.isDeviceWallet(walletuuid)\t\t\n\t\t\t.then((isdevicewallet) => {\n\t\t\t\tif ((this.closing !== true) && (isdevicewallet === true))\n\t\t\t\tthis.setState({isdevicewallet});\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.log('error in Header.componentDidUpdate: ' + err);\n\t\t\t});\n\t\t}\n\t}\n\t\t\n\tcomponentDidMount() {\n\t\tconsole.log('Header.componentDidMount called');\n\n\t\t// check wallet is unlocked\n\t\tthis.app.checkWalletUnlocked()\n\t\t.then((unlocked) => {\n\t\t\treturn unlocked;\n\t\t})\n\t\t.catch(err => {\n\t\t\tconsole.log('error in Header.componentDidMount: ' + err);\n\t\t});\n\n\t\t// check has a return path\n\t\tthis.app.hasReturnPath()\n\t\t.then((canreturn) => {\n\t\t\tif (canreturn)\n\t\t\tthis.setState({hasReturnPath: true});\n\n\t\t\treturn canreturn;\n\t\t})\n\t\t.catch(err => {\n\t\t\tconsole.log('error in Header.componentDidMount: ' + err);\n\t\t});\n\n\t}\n\n\t// end of life\n\tcomponentWillUnmount() {\n\t\tthis.closing = true;\n\t}\n\n\t// render\n\trenderLock() {\n\t\tconst {hasOpenWallet, isdevicewallet} = this.state;\n\n\t\treturn (\n\t\t\t<span>\n\t\t\t{(hasOpenWallet === true ? \n\t\t\t<span className=\"Lock\">\n\t\t\t<FontAwesomeIcon className=\"LockIcon\" icon={faUnlock} /> \n\t\t\t{(isdevicewallet === true ? <FontAwesomeIcon className=\"DeviceIcon\" icon={faMobileAlt} /> : <></>)} </span> : \n\t\t\t<FontAwesomeIcon className=\"LockIcon\" icon={faLock} />)}\n\t\t\t</span>\n\t\t);\n\n\n\t}\n\n\trenderMenuLink(item, index) {\n\t\tswitch (item.type) {\n\t\t\tcase 'link':\n\t\t\t\treturn (<LinkContainer key={index} to={item.route}><NavDropdown.Item>{item.label}</NavDropdown.Item></LinkContainer>);\n\t\t\tcase 'click':\n\t\t\t\treturn (<LinkContainer key={index} to={item.route}><NavDropdown.Item onClick={item.onclick}>{item.label}</NavDropdown.Item></LinkContainer>);\n\t\t\tcase 'separator':\n\t\t\t\treturn (<NavDropdown.Divider key={index} />);\n\t\t\tdefault:\n\t\t\t\treturn (<></>);\n\t\t}\n\t}\n\n\t_getMenuLinks() {\n\t\tconst {hasOpenWallet, hasReturnPath} = this.state;\n\n\t\tvar menulinks = [];\n\n\t\tif (hasOpenWallet !== true) {\n\t\t\tmenulinks.push({type:'click', route: 'login', onclick: () => {this.app.gotoRoute('login');}, label: 'Login'});\n\t\t}\n\t\tmenulinks.push({type:'link', route: 'logout', label: 'Logout'});\n\n\t\tif (hasReturnPath) {\n\t\t\tmenulinks.push({type:'click', route: 'exit', onclick: () => {this.app.returnToCaller();}, label: 'Exit'});\n\t\t}\n\n\t\t// add extra links\n\t\tif (this.webapp_menulinks && this.webapp_menulinks.length) {\n\t\t\tmenulinks = menulinks.concat(this.webapp_menulinks);\n\t\t}\n\n\t\tmenulinks.push({type:'separator'});\n\t\tmenulinks.push({type:'link', route: 'currencycards', label: 'Currency Cards'});\n\n\t\tmenulinks.push({type:'separator'});\n\t\tmenulinks.push({type:'link', route: 'deeplink', label: 'Enter url'});\n\n\t\tmenulinks.push({type:'separator'});\n\t\tmenulinks.push({type:'link', route: 'datawipe', label: 'Wipe all data'});\n\n\t\tmenulinks.push({type:'separator'});\n\t\tmenulinks.push({type:'link', route: 'about', label: 'About'});\n\n\t\treturn menulinks;\n\t}\n\n\n\trender() {\n\t\tconst menulinks = this._getMenuLinks();\n\n\t\treturn (\n\t\t\t<div className='Header'>\n\t\t\t\t<Navbar bg=\"light\" variant=\"light\" expand=\"lg\">\n\t\t\t\t\t<Navbar.Brand>\n\t\t\t\t\t\t<Link to=\"/\"><FontAwesomeIcon icon={faHome} /></Link>\n\t\t\t\t\t</Navbar.Brand>\n\t\t\t\t\t{this.renderLock()}\n\t\t\t\t\t<NavDropdown title={<FontAwesomeIcon icon={faBars} />} id=\"basic-nav-dropdown\">\n\n\t\t\t\t\t\t{menulinks.map((item, index) => {\n\t\t\t\t\t\t\treturn (this.renderMenuLink(item, index));\n\t\t\t\t\t\t})}\n\n\t\t\t\t\t</NavDropdown>\n\t\t\t\t</Navbar>\n\t\t\t</div>\n\t\t);\n\t}\n\t \n\tstatic getDerivedStateFromProps(nextProps, prevState) {\n\t\t// fill state\n\t\treturn {\n\t\t\tisLoggedIn: nextProps.isLoggedIn,\n\t\t\thasOpenWallet: ((nextProps.currentwalletuuid) && (nextProps.iswalletlocked === false) ? true : false),\n\t\t};\n\t}\n}\n\n// propTypes validation\nHeader.propTypes = {\n\tapp: PropTypes.object.isRequired,\n\trootsessionuuid: PropTypes.string,\n\tisLoggedIn: PropTypes.bool,\n\tlastLoggedInCheck: PropTypes.number,\n\tloggedInCheckPending: PropTypes.bool,\n\tcurrentwalletuuid: PropTypes.string,\n\tunlockpending: PropTypes.bool,\n\tiswalletlocked: PropTypes.bool,\n};\n\n//redux\nconst mapStateToProps = (state) => {\n\treturn {\n\t\trootsessionuuid: state.session.sessionuuid,\n\t\tisLoggedIn: state.login.success,\n\t\tloggedInCheckPending: state.login.checkpending,\n\t\tlastLoggedInCheck: state.login.checkedon,\n\t\tcurrentwallet: state.wallets.walletname,\n\t\tcurrentwalletuuid: state.wallets.walletuuid,\n\t\tunlockpending: state.wallets.openpending,\n\t\tiswalletlocked: state.wallets.islocked,\n\t};\n}\n\nconst mapDispatchToProps = (dispatch) => {\n\treturn {\n\t};\n}\n\nexport {Header};\nexport default connect(mapStateToProps, mapDispatchToProps)(Header);"],"mappings":"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"}